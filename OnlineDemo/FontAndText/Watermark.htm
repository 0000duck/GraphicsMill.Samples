<!DOCTYPE html>
<html lang="en">
<head>
	<title>Watermark</title>
	<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" />
	<script src="//code.jquery.com/jquery-2.1.1.min.js" type="text/javascript"></script>
	<script type="text/javascript">
		$(function () {
			var canvas = $("#canvas1");

			var image = null;

			function render() {
				var ctx = canvas[0].getContext("2d");

				//Clear
				ctx.clearRect(0, 0, canvas.width(), canvas.height());

				//Image
				if (image != null) {
					ctx.drawImage(image, 0, 0);
				}
			}

			function loadImage() {
				$.ajax({
					url: "../api/FontAndText/RenderWatermark",
					type: "POST",
					data: {
						Type: $("#selectType").val(),
						Text1: $("#inputText1").val(),
						Text2: $("#inputText2").val()
					},
					success: function (b64data) {
						image = new Image();
						image.src = "data:image/png;base64," + b64data;
						image.onload = function () {
							render();
						}
					}
				});
			}

			$("#selectType, #inputText1, #inputText2").bind("change keyup", function () {
				loadImage();
			});

			$("#selectType").bind("change keyup", function () {
				$("#inputText2").prop("disabled", $(this).val() == "RotatedText");
			});

			function init() {
				loadImage();
				render();
			}

			init();
		});
	</script>
</head>
<body>
	<div role="form">
		<div class="form-group">
			<label for="selectType">Type</label>
			<select id="selectType" class="form-control">
				<option value="RotatedText" selected>Rotated text</option>
				<option value="GridAndText">Grid and text</option>
			</select>
		</div>
		<div class="form-group">
			<label for="inputText1">Text 1</label>
			<input id="inputText1" type="text" value="Graphics Mill" class="form-control" />
		</div>
		<div class="form-group">
			<label for="inputText2">Text 2</label>
			<input id="inputText2" type="text" value="© 2014 Aurigma, Inc." class="form-control" disabled />
		</div>
	</div>
	<canvas id="canvas1" width="600" height="450" style="border: 1px solid #f0f0f0;"></canvas>
</body>
</html>
