<!DOCTYPE html>
<html lang="en">
<head>
	<title>Watermark</title>
	<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" />
	<script src="//code.jquery.com/jquery-2.1.1.min.js" type="text/javascript"></script>
	<script type="text/javascript">
		$(function () {
			var canvas = $("#canvas1");

			var image = null;

			function render() {
				var ctx = canvas[0].getContext("2d");

				//Clear
				ctx.clearRect(0, 0, canvas.width(), canvas.height());

				//Image
				if (image != null) {
					ctx.drawImage(image, 0, 0);
				}
			}

			function loadData() {
				$.ajax({
					url: "../api/FontAndText/GetFontLoadingAndTextMeasuring",
					type: "POST",
					data: {
						StringToMeasure: $("#inputStringToMeasure").val(),
						PlainText: $("#inputPlainText").val(),
						RoundText: $("#inputRoundText").val()
					},
					success: function (data) {
						$("pre").text(data.Info);

						image = new Image();
						image.src = "data:image/png;base64," + data.Image;
						image.onload = function () {
							render();
						}
					}
				});
			}

			$("input").bind("change keyup", function () {
				loadData();
			});


			function init() {
				loadData();
				render();
			}

			init();
		});
	</script>
</head>
<body>
	<div role="form">
		<div class="form-group">
			<label for="inputStringToMeasure">String to measure</label>
			<input id="inputStringToMeasure" type="text" value="Some string to measure" class="form-control" />
		</div>
		<div class="form-group">
			<label for="inputPlainText">Plain text</label>
			<input id="inputPlainText" type="text" value="plain text" class="form-control" />
		</div>
		<div class="form-group">
			<label for="inputRoundText">Round text</label>
			<input id="inputRoundText" type="text" value="Art round text" class="form-control" />
		</div>
	</div>
	<pre>Loading...</pre>
	<canvas id="canvas1" width="600" height="250" style="border: 1px solid #f0f0f0;"></canvas>
</body>
</html>
