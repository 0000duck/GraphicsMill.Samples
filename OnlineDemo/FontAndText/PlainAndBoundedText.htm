<!DOCTYPE html>
<html lang="en">
<head>
	<title>Watermark</title>
	<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" />
	<script src="//code.jquery.com/jquery-2.1.1.min.js" type="text/javascript"></script>
	<script type="text/javascript">
		$(function () {
			var canvas = $("#canvas1");

			var image = null;

			function render() {
				var ctx = canvas[0].getContext("2d");

				//Clear
				ctx.clearRect(0, 0, canvas.width(), canvas.height());

				//Image
				if (image != null) {
					ctx.drawImage(image, 0, 0);
				}
			}

			function loadImage() {
				$.ajax({
					url: "../api/FontAndText/RenderPlainAndBoundedText",
					type: "POST",
					data: {
						HorizontalText: $("#inputHorizontalText").val(),
						VerticalText: $("#inputVerticalText").val(),
						BoundedText: $("#textareaBoundedText").val()
					},
					success: function (b64data) {
						image = new Image();
						image.src = "data:image/png;base64," + b64data;
						image.onload = function () {
							render();
						}
					}
				});
			}

			$("input, textarea").bind("change keyup", function () {
				loadImage();
			});


			function init() {
				loadImage();
				render();
			}

			init();
		});
	</script>
</head>
<body>
	<div role="form">
		<div class="form-group">
			<label for="inputHorizontalText">Horizontal text</label>
			<input id="inputHorizontalText" type="text" value="Horizontal" class="form-control" />
		</div>
		<div class="form-group">
			<label for="inputVerticalText">Vertical text</label>
			<input id="inputVerticalText" type="text" value="Vertical" class="form-control" />
		</div>
		<div class="form-group">
			<label for="textareaBoundedText">Bounded text</label>
			<textarea id="textareaBoundedText" class="form-control" style="height:92px;">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras elementum quam ac nisi varius gravida. Mauris ornare, dolor et scelerisque volutpat, enim urna commodo odio, consequat fermentum sem arcu sit amet nisl. Aliquam tincidunt id neque in gravida. Mauris mollis est vulputate suscipit facilisis. Nullam cursus vestibulum est, ac tincidunt libero cursus vel.</textarea>
		</div>
	</div>
	<canvas id="canvas1" width="600" height="250" style="border: 1px solid #f0f0f0;"></canvas>
</body>
</html>
